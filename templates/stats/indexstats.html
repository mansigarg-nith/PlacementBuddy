{% extends 'placement/base.html' %}
{% load static %}

{%block content%}
<section class="ftco-section bg-light">
	<div class="sidebar">
		<div class="sidebar_main">
		  <ul>
			<li>
			  <a href="{%url 'dashboard'%}" title="Homepage">
				<i class="fas fa-home dash"></i>
			  </a>
			</li>
			<li>
			  <a href="{%url 'experiencelist'%}" title="Experience">
				<i class="fa-solid fa-magnifying-glass dash"></i>
			  </a>
			</li>
			<li>
			  <a href="{%url 'writeExperience' %}" title="Post Experience">
				<i class="fa-solid fa-pencil dash"></i>
			  </a>
			</li>
			<li>
			  <a href="{%url 'index' %}" title="Statistics">
				<i class="fa-sharp fa-solid fa-chart-simple dash"></i>
			  </a>
			</li>
			<li>
			  <a href="#" title="Resources">
				<i class="fas fa-hand-holding-usd"></i>
			  </a>
			</li>
			<li>
			  <a href="{%url 'showdrive'%}" title="Drives">
				<i class="fas fa-cog"></i>
			  </a>
			</li>
		  </ul>
		</div>
	  </div>
	<div class="container" >
<div class="row">
	<div class="col-md-6">
	<canvas id="myChartline"></canvas>
	</div>
	<div class="col-md-6">
	<canvas id="myChartBar"></canvas>
	</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<script>
	
	var endpoint = '/stats/api/{{year}}';

	$.ajax({
	method: "GET",
	url: endpoint,
	success: function(data) {
		drawLineGraph(data, 'myChartline');
		drawBarGraph(data, 'myChartBar');
		// console.log("drawing");
	},
	// error: function(error_data) {
	// 	console.log(error_data);
	// }
	})


	function drawLineGraph(data, id) {
		var labels = [];
		
		var chartdata1 = [];
		var chartdata2 = [];
		var chartdata3 = [];
		var chartdata4 = [];
		var chartdata5 = [];
		for(var i=0;i<data.length;i++){
		 labels[i] = data[i].name;
		 chartdata1[i]= data[i].Btech;
		 chartdata2[i] = data[i].Dtech;
		 chartdata3[i] = data[i].Mtech
		 chartdata4[i] = data[i].MBA
		 chartdata5[i] = data[i].MSC
		// console.log(company.name);
	}
    

	// var labels = data.labels;
	var chartLabel1 = "Btech";
	 var chartLabel2 = "Dual Degree";
	 var chartLabel3 = "Mtech";
	 var chartLabel4 = "MBA";
	 var chartLabel5 = "MSC";
	// var chartdata1 = data.chartdata[0];
	// var chartdata2 = data.chartdata[1];
	var ctx = document.getElementById(id).getContext('2d');
	var chart = new Chart(ctx, {
		// The type of chart we want to create
		type: 'line',

		// The data for our dataset
		data: {
		labels: labels,
		datasets: [{
			label: chartLabel1,
			//backgroundColor: 'rgb(255, 100, 200)',
			borderColor: 'rgb(55, 99, 132)',
			data: chartdata1,
		},{
			label: chartLabel2,
			//backgroundColor: 'rgb(255, 100, 200)',
			borderColor: 'rgb(155, 199, 132)',
			data : chartdata2,



		},{
			label: chartLabel3,
			//backgroundColor: 'rgb(255, 100, 200)',
			borderColor: 'rgb(155, 50, 132)',
			data : chartdata3,



		},{
			label: chartLabel4,
			//backgroundColor: 'rgb(255, 100, 200)',
			borderColor: 'rgb(50, 100, 132)',
			data : chartdata4,



		},{
			label: chartLabel5,
			//backgroundColor: 'rgb(255, 100, 200)',
			borderColor: 'rgb(90, 90, 90)',
			data : chartdata5,



		}]
		},

		// Configuration options go here
		options: {
		scales: {
			xAxes: [{
			display: true
			}],
			yAxes: [{
			ticks: {
				beginAtZero: true
			}
			}]
		}
		}

	});
	}

	function drawBarGraph(data, id) {
		
		var chartdata1 = 0
		var chartdata2 = 0;
		var chartdata3 = 0;
		var chartdata4 = 0;
		var chartdata5 = 0;
		for(var i=0;i<data.length;i++){
		 //labels[i] = data[i].name;
		 chartdata1 += data[i].Btech;
		 chartdata2 += data[i].Dtech;
		 chartdata3 += data[i].Mtech
		 chartdata4 += data[i].MBA
		 chartdata5 += data[i].MSC
		// console.log(company.name);
	  }
    
	// var labels = data.labels;
	// var chartLabel1 = "Btech";
	//  var chartLabel2 = "Dual Degree";
	//  var chartLabel3 = "Mtech";
	//  var chartLabel4 = "MBA";
	//  var chartLabel5 = "MSC";
	
	var ctx = document.getElementById(id).getContext('2d');
	var myChart = new Chart(ctx, {
		type: 'pie',
		data: {
		labels: ["Btech","Mtech","Dual Degree","MBA","MSC"],
		datasets: [{
			data: [chartdata1,chartdata2,chartdata3,chartdata4,chartdata5],
			backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)',
	  'rgb(55, 100, 86)',
	  'rgb(55, 5, 80)',
	  'rgb(25, 20, 186)'
    ],
    hoverOffset: 4
			
		}]
		}
	});
	}
</script>
</div>
</section>
{%endblock%}